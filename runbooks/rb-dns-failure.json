{
  "id": "rb-dns-failure",
  "name": "DNS Resolution Failure",
  "description": "Fix DNS resolution issues",
  "priority": "high",
  "requiresApproval": false,
  "triggers": [
    {
      "logName": "System",
      "eventId": 1014,
      "level": "Warning",
      "source": "DNS Client Events"
    },
    {
      "logName": "Application",
      "eventId": 1000,
      "messagePattern": "DNS.*failed"
    }
  ],
  "steps": [
    {
      "type": "powershell",
      "action": "ipconfig /flushdns",
      "params": {}
    },
    {
      "type": "powershell",
      "action": "Clear-DnsClientCache",
      "params": {}
    },
    {
      "type": "service",
      "action": "restart",
      "params": {
        "serviceName": "Dnscache"
      }
    }
  ],
  "fallback_chains": [
    {
      "trigger": "step_failure",
      "condition": {
        "failed_step_type": "service"
      },
      "fallback_steps": [
        {
          "type": "powershell",
          "action": "Stop-Service -Name Dnscache -Force",
          "params": {}
        },
        {
          "type": "powershell",
          "action": "Start-Sleep -Seconds 3; Start-Service -Name Dnscache",
          "params": {}
        },
        {
          "type": "powershell",
          "action": "Resolve-DnsName -Name google.com -ErrorAction Stop",
          "params": {},
          "allowFailure": true
        }
      ]
    }
  ],
  "risk_class": "A",
  "auto_execute_threshold": 85
}
