{
  "id": "rb-network-adapter-issue",
  "name": "Network Adapter Issue",
  "description": "Reset network adapter when connectivity issues detected",
  "priority": "high",
  "requiresApproval": false,
  "triggers": [
    {
      "logName": "System",
      "eventId": 4202,
      "level": "Warning"
    },
    {
      "logName": "System",
      "eventId": 27,
      "level": "Error",
      "source": "e1iexpress"
    }
  ],
  "steps": [
    {
      "type": "diagnostic",
      "action": "network",
      "params": {}
    },
    {
      "type": "powershell",
      "action": "ipconfig /release",
      "params": {}
    },
    {
      "type": "powershell",
      "action": "ipconfig /renew",
      "params": {}
    },
    {
      "type": "powershell",
      "action": "ipconfig /flushdns",
      "params": {}
    }
  ],
  "fallback_chains": [
    {
      "trigger": "step_failure",
      "condition": {
        "failed_step_type": "powershell"
      },
      "fallback_steps": [
        {
          "type": "powershell",
          "action": "netsh int ip reset",
          "params": {}
        },
        {
          "type": "powershell",
          "action": "netsh winsock reset",
          "params": {}
        },
        {
          "type": "powershell",
          "action": "ipconfig /renew",
          "params": {},
          "allowFailure": true
        }
      ]
    }
  ],
  "risk_class": "A",
  "auto_execute_threshold": 85
}
